

```plain
题目
1.签到 提交:[堡垒机的flag标签的值]
2.提交攻击者第一次登录时间 格式为:[2024/00/00/00:00:00]
3.提交攻击者源IP 格式为:[0.0.0.0]
4.提交攻者使用的cve编号 格式为:[CVE-0000-0000]
5.提交攻击者留着web服务器上的恶意程序的32位小写md5 格式为:[xxxxxx]
6.分析恶意程序连接地址和密码 格式为:[md5(地址)-md5(密码)]全小写
7.提交存在反序列化漏洞的端口 格式为:[md5(端口)]
8.提交攻击者使用的后门路由地址 格式为:[md5(/api/xxx)]
9.提交dnslog反弹域名 格式为:[md5(域名)]
10.提交第一次扫描器使用时间 格式为:[2024/00/00/00:00:00]
11.提交攻击者反弹shell使用的语言 格式为:[md5(c++&java)]均为小写
12.提交攻击者反弹shell的ip 格式为:[xxx.xxx.xxx.xxx]
13.提交攻击者留下的账号 格式为:[xxxxx]
14.提交攻击者的后门账户密码 格式为:[md5(password)]
15.提交测试数据条数 格式为[md5(xxx)]
16.请提交攻击者留下的信息 格式为:[xxxx]
17.请提交运维服务器上的恶意文件md5小写32 格式为:[xxxx]
18.提交恶意文件的恶意函数 格式为:[md5(恶意函数)]
19.请提交攻击者恶意注册的恶意用户条数 格式为:[md5(x)]
20.请提交对博客系统的第一次扫描时间 格式为:[2024/00/00/00:00:00]
21.提交攻击者下载的文件 格式为[xxxx.xxx]
22.请提交攻击者第一次下载的时间 格式为:[xx/Apr/2024:xx:xx:xx]
23.请提交攻击者留下的冰蝎马的文件名称 格式为:[xxxx]
24.提交冰蝎的链接密码 格式为:[xxx]
25.提交办公区存在的恶意用户名 格式为:[xxx]
26.提交恶意用户密码到期时间 格式为:[xxxx]
27.请对办公区留存的镜像取证并指出内存疑似恶意进程 格式为:[xxxx]
28.请指出该员工使用的公司OA平台的密码 格式为:[xxxx]
29.攻击者传入一个木马文件并做了权限维持，请问木马文件名是什 么 格式为:[xxxx]
30.请提交该计算机中记录的重要联系人的家庭住址 格式为:[xxxxx]
31.请提交近源靶机上的恶意文件哈希 格式为:[xxx]
32.提交恶意程序的外联地址 格式为:[xxxxx]
33.提交攻击者使用内网扫描工具的哈希 格式为:[xxxx]
34.请提交攻击者在站点上留下的后门密码 格式为:[xxxx]
35.请提交攻击者在数据库留下的信息 格式为:[xxxx]
36.提交攻击者在监控服务器上留下的dcnlog地址 格式为:[xxx.xx.xx]
37.提交监控服务器上恶意用户的上一次登录时间 格式为:[xx/xx/xx/xx:xx:xx]
38.提交监控服务器上遗留的反弹shell地址和端口 格式为:[xxxx:xx]
39.提交恶意钓鱼文件的哈希 格式为:[xxxx]
40.提交恶意文件外联IP 格式为:[xxx] （可能不对）
41.提交被恶意文件钓鱼使用者的姓名 格式为:[xxx]
42.提交攻击者留下的信息 格式为:[xxxx]
43.提交恶意用户数量 格式为:[md5(xxxx)]
44.请提交员工集体使用的密码 格式为:[xxxx]
45.提交加密文件的哈希 格式为:[xxxx]
46.提交被攻击者加密的内容明文 格式为:[xxxx]
47.请提交符合基线标准的服务器数量 格式为:[md5(xx)]
48.提交办公区的恶意文件哈希 格式为:[xxx]
49.提交恶意回连端口 格式为:[xxx]
50.提交恶意程序中的falg 格式为:[xxx]
51.提交恶意文件中的search_for_text内容 格式为:[xxxx]
52.提交web服务器上攻击者修改后的root密码 格式为:[xxxx]
```

![image-20250415190713905](../帕鲁杯应急响应.assets/image-20250415190713905.png)

![image-20250415190724814](../帕鲁杯应急响应.assets/image-20250415190724814.png)

1. 直接翻一翻就找到了

    ![image-20250415190737418](../帕鲁杯应急响应.assets/image-20250415190737418.png)

2. 这里的登录指的是登录上jumpserver这么多的登录信息只选这个是因为他的登录城市是LAN，也就是通过内网登录
    ![image-20250415190748062](../帕鲁杯应急响应.assets/image-20250415190748062.png)

3. 直接找登录IP次数最多的
    ![image-20250415190754839](../帕鲁杯应急响应.assets/image-20250415190754839.png)

4. 直接搜索JumpServer的CVE历史漏洞
    ![image-20250415190806517](../帕鲁杯应急响应.assets/image-20250415190806517.png)

5. 由于我们不知道被修改的webserver的密码，所以我们查看硬盘信息 所以使用DiskGenius打开虚拟硬盘内存取证
    ![image-20250415190846452](../帕鲁杯应急响应.assets/image-20250415190846452.png)
    ![image-20250415190855248](../帕鲁杯应急响应.assets/image-20250415190855248.png)

6. 进行反编译

  ![](../帕鲁杯应急响应.assets/image-20250415190905132.png)  
  ![image-20250415190915799](../帕鲁杯应急响应.assets/image-20250415190915799.png)
  ![image-20250415190935373](../帕鲁杯应急响应.assets/image-20250415190935373.png)

7. 登录WAF查看最早的攻击事件

  ![image-20250415190949632](../帕鲁杯应急响应.assets/image-20250415191007652.png)  
  查看原始日志可以看到是8080端口 
  ![image-20250415191018196](../帕鲁杯应急响应.assets/image-20250415191018196.png)

8. 发现有两个接口 可以都试试进行md5加密提交 
    ![image-20250415191031919](../帕鲁杯应急响应.assets/image-20250415191031919.png)

9. 因为攻击的是web服务器所以我们去内存取证 可以看到webServer使用flask运维，所以去查看一下日记 可以看到有日志生成

  ![image-20250415191109523](../帕鲁杯应急响应.assets/image-20250415191109523.png)  
可以看到有两个dnslog地址 0vqkht.dnslog.cn和0vqkht.palu.cn![image-20250415191121390](../帕鲁杯应急响应.assets/image-20250415191121390.png)

10. flask的日志记录时间是转换为时间戳 

    [https://tool.lu/timestamp/</font>](https://tool.lu/timestamp/)  
    ![image-20250415191143832](../帕鲁杯应急响应.assets/image-20250415191143832.png)

11. 在日志中搜索一下高级语言  
    ![image-20250415191158412](../帕鲁杯应急响应.assets/image-20250415191158412.png)

12. 日志不算多，可以大概翻翻日志找ip地址，特征明显 ![image-20250415191208755](../帕鲁杯应急响应.assets/image-20250415191208755.png)

13. 直接搜索一下增加用户的命令useradd 还可以搜索passwd命令，一般创建用户之后会设置密码 ![image-20250415191216604](../帕鲁杯应急响应.assets/image-20250415191216604.png)

14. 直接内存取证，去找shadow文件，shadow文件会存账号对应的密码  
    使用hashcat对加密的密码进行爆破
    hashcat.exe --force -m 1800 -a 0 palu.com.txt example.dict -o result.txt
    ![image-20250415191231033](../帕鲁杯应急响应.assets/image-20250415191231033.png)  
    ![image-20250415191245983](../帕鲁杯应急响应.assets/image-20250415191245983.png)

15. 提交测试数据条数的话是去mysql服务器了 
![image-20250415191312500](../帕鲁杯应急响应.assets/image-20250415191312500.png)
16. 去web服务器 内存取证查看中间件的日志 这里是nginx 日志文件在：/var/log/nginx  
![image-20250415191322522](../帕鲁杯应急响应.assets/image-20250415191322522.png)
17. 找运维服务器就两台  Jump和Zabbix
JumpServer服务器上传了个文件 叫helloworld
![image-20250415191330495](../帕鲁杯应急响应.assets/image-20250415191330495.png)

查看相关的helloworld命令
![image-20250415191347847](../帕鲁杯应急响应.assets/image-20250415191347847.png)查看回放
![image-20250415191357705](../帕鲁杯应急响应.assets/image-20250415191357705.png)

18. 恶意文件就是上面的helloworld 用内存取证软件把他拿下来桌面用ida分析
19. 提交攻击者恶意注册的恶意用户条数的话是在web服务器中
    ![image-20250415191432817](../帕鲁杯应急响应.assets/image-20250415191432817.png)
    查看用户表之后去进行查看账号 发现一连串的账号 可能是恶意注册的用户 一共有10个 
    ![image-20250415191527159](../帕鲁杯应急响应.assets/image-20250415191527159.png)
20. 一般扫描都会被WAF拦截，时间少拦截大基本就是扫描行为引起的了  
![image-20250415191534484](../帕鲁杯应急响应.assets/image-20250415191534484.png)
21. WAF查看webserver资源发现单独的文件目录![image-20250415191543021](../帕鲁杯应急响应.assets/image-20250415191543021.png)
22. 查看jumpserver的文件传输，文件下载会出现在jumpserver的web页面上![image-20250415191550365](../帕鲁杯应急响应.assets/image-20250415191550365.png)
内存取证软件拿出来日志文件 
![image-20250415191600036](../帕鲁杯应急响应.assets/image-20250415191600036.png)
23. 搜索冰蝎马常见可执行文件，所以去jumpserver搜索相关的命令![image-20250415191628385](../帕鲁杯应急响应.assets/image-20250415191628385.png)
24. 这里的key就是密码 拿去MD5解密 解密出来结果是nidewen![image-20250415191636268](../帕鲁杯应急响应.assets/image-20250415191636268.png)
25. 办公区只有pc1和pc2，所以登录看看pc1，出现了这个用户hacker![image-20250415191645625](../帕鲁杯应急响应.assets/image-20250415191645625.png)
26. 直接登录管理员账号进去里面使用命令查看 ![image-20250415191653415](../帕鲁杯应急响应.assets/image-20250415191653415.png)
27. 看到内存文件  
![image-20250415191703758](../帕鲁杯应急响应.assets/image-20250415191703758.png)使用volatility工具进行内存镜像分析  
volatility_2.6_win64_standalone.exe -f raw.raw imageinfo查看相关镜像信息
![image-20250415191711594](../帕鲁杯应急响应.assets/image-20250415191711594.png)volatility_2.6_win64_standalone.exe -f raw.raw --profile=Win7SP1x64 pslist  ![image-20250415191720619](../帕鲁杯应急响应.assets/image-20250415191720619.png)
28. 想到OA密码，一般会进行web页面进行登录
volatility_2.6_win64_standalone.exe -f raw.raw --profile=Win7SP1x64 iehistory 
iehistory 指的是ie浏览器历史记录![image-20250415191728830](../帕鲁杯应急响应.assets/image-20250415191728830.png)再用filescan扫描文件 filescan 命令的输出通过管道|传递给findstr命令来搜索包含 “password” 的行 ![image-20250415191735887](../帕鲁杯应急响应.assets/image-20250415191735887.png)接着使用dumpfiles爆破文件内容 
![image-20250415191742545](../帕鲁杯应急响应.assets/image-20250415191742545.png)最够看保存的文件 OA系统密码到手 ![image-20250415191750435](../帕鲁杯应急响应.assets/image-20250415191750435.png)
29. ![image-20250415191801348](../帕鲁杯应急响应.assets/image-20250415191801348.png)
30. Contacts\: 在 Windows 用户文件夹中，Contacts 通常是用来存储联系人信息的文件夹。  
![image-20250415191807270](../帕鲁杯应急响应.assets/image-20250415191807270.png)![image-20250415191812830](../帕鲁杯应急响应.assets/image-20250415191812830.png) 
![image-20250415191820330](../帕鲁杯应急响应.assets/image-20250415191820330.png)
31. 登录进去能看到最近使用的文件
![image-20250415191836044](../帕鲁杯应急响应.assets/image-20250415191836044.png)
32. 把解压的文件放到微步云沙箱进行分析
33. 内网扫描工具一般都是fscan，所以去jumpserver查看有关fscan的命令 
34. ![image-20250415191844454](../帕鲁杯应急响应.assets/image-20250415191844454.png)
35. 一个一个查看数据库
36. 监控服务器是zabbix  ![image-20250415191851677](../帕鲁杯应急响应.assets/image-20250415191851677.png)
37. ![image-20250415191859216](../帕鲁杯应急响应.assets/image-20250415191859216.png)
38. ![image-20250415191906670](../帕鲁杯应急响应.assets/image-20250415191906670.png) ![image-20250415191912932](../帕鲁杯应急响应.assets/image-20250415191912932.png)
39. 在PC2主机的快速访问的文件中，一个一个拿去云沙箱等去试
40. 沙箱看
41. 搜索带有钓鱼文件的路径，路径有名字
42. pc2中使用了注册表，看回放
43. 去pc2使用net user命令查看用户数量，数一数49个
44. 一般Windows的用户密码都是在C:\Windows\System32\config里的SAM和SYSTEM
导出来reg save hklm\sam sam.hiv reg save hklm\system system.hiv 
使用samdump2 工具导出hash值 
samdump2 system sam > hash.txt 
所以用户和Administrator的hash值都一样，所以密码为
45. 加密文件是在PC2的encode.txt中
46. 使用玛卡巴卡解密工具
47. 全部被被攻破，为0
48. 在堡垒机中搜索办公机，看恶意文件
49. 反编译能看
50. 反编译能看
51. 反编译能看
52. 把web服务器的shadow导出来就行cmd5付费解密还可以进行hashcat或者john爆破
