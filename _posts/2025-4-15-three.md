---
layout: post
title: "帕鲁杯应急响应"
date:   2025-4-15
comments: true
author: laitya1
---

```plain
题目
1.签到 提交:[堡垒机的flag标签的值]
2.提交攻击者第一次登录时间 格式为:[2024/00/00/00:00:00]
3.提交攻击者源IP 格式为:[0.0.0.0]
4.提交攻者使用的cve编号 格式为:[CVE-0000-0000]
5.提交攻击者留着web服务器上的恶意程序的32位小写md5 格式为:[xxxxxx]
6.分析恶意程序连接地址和密码 格式为:[md5(地址)-md5(密码)]全小写
7.提交存在反序列化漏洞的端口 格式为:[md5(端口)]
8.提交攻击者使用的后门路由地址 格式为:[md5(/api/xxx)]
9.提交dnslog反弹域名 格式为:[md5(域名)]
10.提交第一次扫描器使用时间 格式为:[2024/00/00/00:00:00]
11.提交攻击者反弹shell使用的语言 格式为:[md5(c++&java)]均为小写
12.提交攻击者反弹shell的ip 格式为:[xxx.xxx.xxx.xxx]
13.提交攻击者留下的账号 格式为:[xxxxx]
14.提交攻击者的后门账户密码 格式为:[md5(password)]
15.提交测试数据条数 格式为[md5(xxx)]
16.请提交攻击者留下的信息 格式为:[xxxx]
17.请提交运维服务器上的恶意文件md5小写32 格式为:[xxxx]
18.提交恶意文件的恶意函数 格式为:[md5(恶意函数)]
19.请提交攻击者恶意注册的恶意用户条数 格式为:[md5(x)]
20.请提交对博客系统的第一次扫描时间 格式为:[2024/00/00/00:00:00]
21.提交攻击者下载的文件 格式为[xxxx.xxx]
22.请提交攻击者第一次下载的时间 格式为:[xx/Apr/2024:xx:xx:xx]
23.请提交攻击者留下的冰蝎马的文件名称 格式为:[xxxx]
24.提交冰蝎的链接密码 格式为:[xxx]
25.提交办公区存在的恶意用户名 格式为:[xxx]
26.提交恶意用户密码到期时间 格式为:[xxxx]
27.请对办公区留存的镜像取证并指出内存疑似恶意进程 格式为:[xxxx]
28.请指出该员工使用的公司OA平台的密码 格式为:[xxxx]
29.攻击者传入一个木马文件并做了权限维持，请问木马文件名是什 么 格式为:[xxxx]
30.请提交该计算机中记录的重要联系人的家庭住址 格式为:[xxxxx]
31.请提交近源靶机上的恶意文件哈希 格式为:[xxx]
32.提交恶意程序的外联地址 格式为:[xxxxx]
33.提交攻击者使用内网扫描工具的哈希 格式为:[xxxx]
34.请提交攻击者在站点上留下的后门密码 格式为:[xxxx]
35.请提交攻击者在数据库留下的信息 格式为:[xxxx]
36.提交攻击者在监控服务器上留下的dcnlog地址 格式为:[xxx.xx.xx]
37.提交监控服务器上恶意用户的上一次登录时间 格式为:[xx/xx/xx/xx:xx:xx]
38.提交监控服务器上遗留的反弹shell地址和端口 格式为:[xxxx:xx]
39.提交恶意钓鱼文件的哈希 格式为:[xxxx]
40.提交恶意文件外联IP 格式为:[xxx] （可能不对）
41.提交被恶意文件钓鱼使用者的姓名 格式为:[xxx]
42.提交攻击者留下的信息 格式为:[xxxx]
43.提交恶意用户数量 格式为:[md5(xxxx)]
44.请提交员工集体使用的密码 格式为:[xxxx]
45.提交加密文件的哈希 格式为:[xxxx]
46.提交被攻击者加密的内容明文 格式为:[xxxx]
47.请提交符合基线标准的服务器数量 格式为:[md5(xx)]
48.提交办公区的恶意文件哈希 格式为:[xxx]
49.提交恶意回连端口 格式为:[xxx]
50.提交恶意程序中的falg 格式为:[xxx]
51.提交恶意文件中的search_for_text内容 格式为:[xxxx]
52.提交web服务器上攻击者修改后的root密码 格式为:[xxxx]
```

![](https://cdn.nlark.com/yuque/0/2025/png/49146040/1744690373301-4053dc2b-ffe0-46ee-96c9-9bfdf5ae36e1.png)![](https://cdn.nlark.com/yuque/0/2025/png/49146040/1744690373370-3cc0bc08-5de3-464c-b61e-53e4b6ace4fd.png)

1. <font style="color:#000000;">直接翻一翻就找到了</font>![](assets/image-20250415103455285.png)

![](https://cdn.nlark.com/yuque/0/2025/png/49146040/1744690377099-24c5c5f4-01ba-436d-8905-2bfd69d216c4.png)

2. <font style="color:#000000;">这里的登录指的是登录上jumpserver这么多的登录信息只选这个是因为他的登录城市是</font>[<font style="color:#000000;">LAN</font>](https://so.csdn.net/so/search?q=LAN&spm=1001.2101.3001.7020)<font style="color:#000000;">，也就是通过内网登录</font>![](assets/image-20250415104253517.png)<font style="color:#000000;">  
![](https://cdn.nlark.com/yuque/0/2025/png/49146040/1744690383364-5a7f1161-73ea-4253-a392-8a5e1ee72fc2.png)
3. <font style="color:#000000;">直接找登录IP次数最多的</font>![](assets/image-20250415104416911.png)<font style="color:#000000;">  
</font>![](https://cdn.nlark.com/yuque/0/2025/png/49146040/1744690387700-c92215c9-bc86-46f9-831f-992666f9d0e3.png)
4. <font style="color:#000000;">直接搜索JumpServer的CVE历史漏洞</font>![](assets/image-20250415104611606.png)<font style="color:#000000;">  
</font>![](https://cdn.nlark.com/yuque/0/2025/png/49146040/1744690392449-221823e4-c096-481d-85b8-1f86dd7de8ee.png)
5. <font style="color:#000000;">由于我们不知道被修改的webserver的密码，所以我们查看硬盘信息 所以使用DiskGenius打开虚拟硬盘内存取证</font>![](assets/image-20250415105554488.png)![](assets/image-20250415105813971.png)<font style="color:#000000;">  
</font>![](https://cdn.nlark.com/yuque/0/2025/png/49146040/1744690395918-57715e6e-f149-446b-8eef-37c818e198b6.png)<font style="color:#000000;">  
</font>![](https://cdn.nlark.com/yuque/0/2025/png/49146040/1744690406914-ae41b5a0-57c9-4e1e-9d7a-5bbc7647b040.png)
6. <font style="color:#000000;">进行反编译</font>![](assets/image-20250415120415997.png)![](assets/image-20250415120314652.png)<font style="color:#000000;">  
</font>![](https://cdn.nlark.com/yuque/0/2025/png/49146040/1744690406966-dc360323-369d-484c-92fb-d9b7be925f6c.png)![](https://cdn.nlark.com/yuque/0/2025/png/49146040/1744690407023-0f2a3d41-6d73-4560-a079-83f8c6ea6251.png)<font style="color:#000000;">  
</font>![](https://cdn.nlark.com/yuque/0/2025/png/49146040/1744690507881-f2e987ff-6dd6-4a2c-9e68-f54300307448.png)
7. <font style="color:#000000;">登录WAF查看最早的攻击事件  
</font>![](https://cdn.nlark.com/yuque/0/2025/png/49146040/1744691058857-73e709f7-209a-4108-a75a-51cecb4fa988.png)<font style="color:#000000;">  
</font><font style="color:#000000;">查看原始日志可以看到是8080端口  
</font>![](https://cdn.nlark.com/yuque/0/2025/png/49146040/1744691100207-1eb2ecfa-5289-44f5-8fa0-e156aaf8c19f.png)
8. <font style="color:#000000;">发现有两个接口 可以都试试进行md5加密提交  
</font>![](https://cdn.nlark.com/yuque/0/2025/png/49146040/1744691294690-48b0612e-fa3c-4ea9-8acb-450033cc4364.png)
9. <font style="color:#000000;">因为攻击的是web服务器所以我们去内存取证 可以看到webServer使用flask运维，所以去查看一下日记 可以看到有日志生成  
</font>![](https://cdn.nlark.com/yuque/0/2025/png/49146040/1744691659394-3f4b1d60-58bb-4d1d-b0e1-307b352d839b.png)<font style="color:#000000;">  
</font><font style="color:#000000;">可以看到有两个dnslog地址 0vqkht.dnslog.cn和0vqkht.palu.cn  
</font>![](https://cdn.nlark.com/yuque/0/2025/png/49146040/1744691773000-30d0cfa0-2351-4fb9-a3d5-018c5d4bc06e.png)
10. <font style="color:#000000;">flask的日志记录时间是转换为时间戳  
</font>[<font style="color:#000000;">https://tool.lu/timestamp/</font>](https://tool.lu/timestamp/)<font style="color:#000000;">  
</font>![](https://cdn.nlark.com/yuque/0/2025/png/49146040/1744692491376-0461ff8c-0bf1-4131-9e0e-e308f5472259.png)
11. <font style="color:#000000;">在日志中搜索一下高级语言  
</font>![](https://cdn.nlark.com/yuque/0/2025/png/49146040/1744692551630-b7818588-4fcd-4b4e-ae60-585e83ace922.png)
12. <font style="color:#000000;">日志不算多，可以大概翻翻日志找ip地址，特征明显  
</font>![](https://cdn.nlark.com/yuque/0/2025/png/49146040/1744692637299-f7588fc6-1cbd-4978-bfce-c8a13543d7a1.png)
13. <font style="color:#000000;">直接搜索一下增加用户的命令useradd 还可以搜索passwd命令，一般创建用户之后会设置密码  
</font>![](https://cdn.nlark.com/yuque/0/2025/png/49146040/1744692735241-92386957-93fc-4d65-913d-294cc986329c.png)
14. <font style="color:#000000;">直接内存取证，去找shadow文件，shadow文件会存账号对应的密码  
</font><font style="color:#000000;">使用hashcat对加密的密码进行爆破   
</font><font style="color:#000000;">hashcat.exe --force -m 1800 -a 0 palu.com.txt example.dict -o result.txt</font>

_**<font style="color:#000000;background-color:rgb(249, 249, 249);">-m 1800</font>**_<font style="color:#000000;">：指定SHA-512加密算法。</font>

_**<font style="color:#000000;background-color:rgb(249, 249, 249);">-a 0</font>**_<font style="color:#000000;">：使用字典攻击模式。</font>

_**<font style="color:#000000;background-color:rgb(249, 249, 249);">--force</font>**_<font style="color:#000000;">：忽略警告信息。</font>

_**<font style="color:#000000;background-color:rgb(249, 249, 249);">-o results.txt</font>**_<font style="color:#000000;">：将破解结果输出到</font>_**<font style="color:#000000;background-color:rgb(249, 249, 249);">results.txt</font>**_<font style="color:#000000;">文件。  
</font>![](https://cdn.nlark.com/yuque/0/2025/png/49146040/1744693615405-7d71c51c-19b5-4d99-96ec-0f4234ac4911.png)<font style="color:#000000;">  
</font>![](https://cdn.nlark.com/yuque/0/2025/png/49146040/1744693587984-d01502df-7c90-49d0-b32f-4f52486b0343.png)

15. <font style="color:#000000;">提交测试数据条数的话是去mysql服务器了  
</font>![](https://cdn.nlark.com/yuque/0/2025/png/49146040/1744693822877-6bb7eedf-7001-4a9f-befa-a2d5cb1e384a.png)
16. <font style="color:#000000;">去web服务器 内存取证查看中间件的日志 这里是nginx 日志文件在：/var/log/nginx  
</font>![](https://cdn.nlark.com/yuque/0/2025/png/49146040/1744693946888-78cca8a5-e45e-4f6e-809f-d5def10e689b.png)
17. <font style="color:#000000;">找运维服务器就两台  Jump和Zabbix  
</font><font style="color:#000000;">JumpServer服务器上传了个文件 叫helloworld  
</font>![](https://cdn.nlark.com/yuque/0/2025/png/49146040/1744694139763-ef7a6984-ac69-44f5-a8bd-864c925e8680.png)

<font style="color:#000000;">查看相关的helloworld命令  
</font>![](https://cdn.nlark.com/yuque/0/2025/png/49146040/1744695172375-f2bb8194-5a54-4b53-98fe-246f4426970a.png)<font style="color:#000000;">  
</font><font style="color:#000000;">查看回放  
</font>![](https://cdn.nlark.com/yuque/0/2025/png/49146040/1744695165858-983526a1-d98f-48ea-a59d-9ffb71e3ad15.png)

18. <font style="color:#000000;">恶意文件就是上面的helloworld 用内存取证软件把他拿下来桌面用ida分析  
</font>![](https://cdn.nlark.com/yuque/0/2025/png/49146040/1744695677791-05898020-c1b7-4ce1-a622-7313a9164682.png)<font style="color:#000000;">  
</font><font style="color:#000000;">存在两个函数</font>
19. <font style="color:#000000;">提交攻击者恶意注册的恶意用户条数的话是在web服务器中  
</font>![](https://cdn.nlark.com/yuque/0/2025/png/49146040/1744696324123-6ddbef06-caca-4009-9a46-80d2fa8139b4.png)<font style="color:#000000;">  
</font><font style="color:#000000;">查看用户表之后去进行查看账号 发现一连串的账号 可能是恶意注册的用户 一共有10个  
</font>![](https://cdn.nlark.com/yuque/0/2025/png/49146040/1744696703977-e4782d57-fb43-4ee5-8fab-6703d1e2ddb3.png)
20. <font style="color:#000000;">一般扫描都会被WAF拦截，时间少拦截大基本就是扫描行为引起的了  
</font>![](https://cdn.nlark.com/yuque/0/2025/png/49146040/1744696912055-d5ba9e72-6109-4823-a28b-a04e69598f4d.png)
21. <font style="color:#000000;">WAF查看webserver资源发现单独的文件目录  
</font>![](https://cdn.nlark.com/yuque/0/2025/png/49146040/1744697677235-6e17a535-90bd-4787-877b-245154741cbc.png)
22. <font style="color:#000000;">查看jumpserver的文件传输，文件下载会出现在jumpserver的web页面上</font><font style="color:#000000;">  
</font>![](https://cdn.nlark.com/yuque/0/2025/png/49146040/1744698018807-8213f5a7-f320-4c27-9b6d-862a716e4390.png)<font style="color:#000000;">  
</font><font style="color:#000000;">内存取证软件拿出来日志文件  
</font>![](https://cdn.nlark.com/yuque/0/2025/png/49146040/1744698274027-36c6f06e-56e7-45f4-88b6-faed9b4bcecd.png)<font style="color:#000000;">  
</font>![](https://cdn.nlark.com/yuque/0/2025/png/49146040/1744698255587-6602ae57-8075-466e-a4ac-2d76e0b50da3.png)
23. <font style="color:#000000;">搜索冰蝎马常见可执行文件，所以去jumpserver搜索相关的命令  
</font>![](https://cdn.nlark.com/yuque/0/2025/png/49146040/1744698407309-f99e8f8b-2ba1-43a5-a491-855561d43926.png)
24. <font style="color:#000000;">这里的key就是密码 拿去MD5解密 解密出来结果是nidewen  
</font>![](https://cdn.nlark.com/yuque/0/2025/png/49146040/1744698441375-3bcdbddc-f9e6-484a-8a8c-d9e34bab41ff.png)
25. <font style="color:#000000;">办公区只有pc1和pc2，所以登录看看pc1，出现了这个用户hacker  
</font>![](https://cdn.nlark.com/yuque/0/2025/png/49146040/1744701245270-7dabb66d-c398-46b8-bac1-ba352d8ff94b.png)
26. <font style="color:#000000;">直接登录管理员账号进去里面使用命令查看  
</font>![](https://cdn.nlark.com/yuque/0/2025/png/49146040/1744701370319-986390c5-2892-4ef6-9818-9fb415171a47.png)
27. <font style="color:#000000;">看到内存文件  
</font>![](https://cdn.nlark.com/yuque/0/2025/png/49146040/1744701459351-5cb0f133-8185-4f4b-9aa3-37e3a1adbbe8.png)<font style="color:#000000;">  
</font><font style="color:#000000;">使用volatility工具进行内存镜像分析  
</font><font style="color:#000000;">volatility_2.6_win64_standalone.exe -f raw.raw imageinfo查看相关镜像信息  
</font>![](https://cdn.nlark.com/yuque/0/2025/png/49146040/1744703165024-7888b0e5-2718-4a79-8f09-691d43e0ee1c.png)<font style="color:#000000;">  
</font><font style="color:#000000;">volatility_2.6_win64_standalone.exe -f raw.raw --profile=Win7SP1x64 pslist  
</font>![](https://cdn.nlark.com/yuque/0/2025/png/49146040/1744702770062-ffe7026b-fcaa-42b8-87f7-93206a0aeb60.png)
28. <font style="color:#000000;">想到OA密码，一般会进行web页面进行登录  
</font><font style="color:#000000;">volatility_2.6_win64_standalone.exe -f raw.raw --profile=Win7SP1x64 iehistory  
</font><font style="color:#000000;">iehistory 指的是ie浏览器历史记录  
</font>![](https://cdn.nlark.com/yuque/0/2025/png/49146040/1744703217133-7a437bb9-afbd-4ace-9431-4c776e46f121.png)<font style="color:#000000;">  
</font><font style="color:#000000;">再用filescan扫描文件 filescan 命令的输出通过管道|传递给findstr命令来搜索包含 “password” 的行  
</font>![](https://cdn.nlark.com/yuque/0/2025/png/49146040/1744703356878-1fabf8d7-c3d9-4b19-96cd-fd141877a059.png)<font style="color:#000000;">接着使用dumpfiles爆破文件内容  
</font>![](https://cdn.nlark.com/yuque/0/2025/png/49146040/1744703660474-8078535b-8bc0-4fa1-a4bb-41680f26f3c1.png)<font style="color:#000000;">  
</font><font style="color:#000000;">最够看保存的文件 OA系统密码到手  
</font>![](https://cdn.nlark.com/yuque/0/2025/png/49146040/1744703688705-973d42fc-49cd-43b0-ba8c-44c9f28ff89b.png)
29. <font style="color:#000000;">  
</font>![](https://cdn.nlark.com/yuque/0/2025/png/49146040/1744704394207-9bd40ca9-6bea-40b2-836d-06a831895d50.png)
30. <font style="color:#000000;">Contacts\: 在 Windows 用户文件夹中，Contacts 通常是用来存储联系人信息的文件夹。  
</font>![](https://cdn.nlark.com/yuque/0/2025/png/49146040/1744704783210-fa2783ea-04d1-4d81-9ce1-c2d8efa6ca32.png)<font style="color:#000000;">  
</font>![](https://cdn.nlark.com/yuque/0/2025/png/49146040/1744704798963-f9ba1eed-883b-4f0c-b421-4ab824092a14.png)<font style="color:#000000;">  
</font>![](https://cdn.nlark.com/yuque/0/2025/png/49146040/1744704841204-15f0ae08-811a-4b20-b418-339e71411bcc.png)
31. <font style="color:#000000;">登录进去能看到最近使用的文件  
</font>![](https://cdn.nlark.com/yuque/0/2025/png/49146040/1744704962614-f99fdff3-dadc-4237-9068-99bc4d7b924b.png)
32. <font style="color:#000000;">把解压的文件放到微步云沙箱进行分析</font>
33. <font style="color:#000000;">内网扫描工具一般都是fscan，所以去jumpserver查看有关fscan的命令 </font>
34. <font style="color:#000000;">  
</font>![](https://cdn.nlark.com/yuque/0/2025/png/49146040/1744706156840-0d7f2bd6-33b7-4a2e-8ea2-0d8b0282e013.png)
35. <font style="color:#000000;">一个一个查看数据库</font>
36. <font style="color:#000000;">监控服务器是zabbix  
</font>![](https://cdn.nlark.com/yuque/0/2025/png/49146040/1744706519072-2251e5e3-cc8c-4766-a228-c061d8bf5b61.png)
37. <font style="color:#000000;">  
</font>![](https://cdn.nlark.com/yuque/0/2025/png/49146040/1744706558757-f07ad539-9fc2-426f-b32b-b5161f7c034c.png)
38. <font style="color:#000000;">  
</font>![](https://cdn.nlark.com/yuque/0/2025/png/49146040/1744706692873-05e64b1b-cc48-4541-95b7-85033c042578.png)<font style="color:#000000;">  
</font>![](https://cdn.nlark.com/yuque/0/2025/png/49146040/1744706674487-9ef6b5e8-a4fd-42db-8750-1277a153aecb.png)
39. <font style="color:#000000;">在PC2主机的快速访问的文件中，一个一个拿去云沙箱等去试</font>
40. <font style="color:#000000;">沙箱看</font>
41. <font style="color:#000000;">搜索带有钓鱼文件的路径，路径有名字</font>
42. <font style="color:#000000;">pc2中使用了注册表，看回放</font>
43. <font style="color:#000000;">去pc2使用net user命令查看用户数量，数一数49个</font>
44. <font style="color:#000000;">一般Windows的用户密码都是在C:\Windows\System32\config里的SAM和SYSTEM  
</font><font style="color:#000000;">导出来reg save hklm\sam sam.hiv reg save hklm\system system.hiv  
</font><font style="color:#000000;">使用samdump2 工具导出hash值  
</font><font style="color:#000000;">samdump2 system sam > hash.txt  
</font><font style="color:#000000;">所以用户和Administrator的hash值都一样，所以密码为</font>
45. <font style="color:#000000;">加密文件是在PC2的encode.txt中</font>
46. <font style="color:#000000;">使用玛卡巴卡解密工具</font>
47. <font style="color:#000000;">全部被被攻破，为0</font>
48. <font style="color:#000000;">在堡垒机中搜索办公机，看恶意文件</font>
49. <font style="color:#000000;">反编译能看</font>
50. <font style="color:#000000;">反编译能看</font>
51. <font style="color:#000000;">反编译能看</font>
52. <font style="color:#000000;">把web服务器的shadow导出来就行cmd5付费解密还可以进行hashcat或者john爆破</font>

<font style="color:#000000;"></font>

